<!DOCTYPE html>
<html>
<head>
	<title>Blue skies</title>
</head>
<body>

	<form action="upload.php" method="post" enctype="multipart/form-data">
	    Select image to upload:
	    <input type="file" name="Upload_file" id="Upload_file">
	    <input type="submit" value="Upload CSV" name="submit">
	</form>

	<form action="visAOI.php" method="post">
		Input AOI:
		<input type="number" name="xmin" min="0">
		<input type="number" name="xmax" min="0">

		<input type="number" name="ymin" min="0">
		<input type="number" name="ymax" min="0">

		<input type="submit" value="AOI" name="submit">
	</form>

	<canvas id="myCanvas" width="600" height="600"></canvas>

	<script type="text/javascript">


		var data = {"switchtimes":[[["0","0"],["683","1"]],[["0","1"],["283","0"],["583","1"],["1582","0"],["2232","1"],["2981","0"],["3448","1"],["4181","0"],["4697","1"]],[["0","0"],["1782","1"],["1932","0"],["2248","1"],["3697","0"],["4180","1"],["5546","0"]],[["0","1"],["516","0"],["1116","1"],["1382","0"],["1882","1"],["3314","0"],["4230","1"]],[["0","0"],["350","1"],["1816","0"],["2632","1"],["5281","0"],["6330","1"]],[["0","0"],["500","1"],["616","0"],["816","1"],["1049","0"],["1266","1"],["1466","0"],["1799","1"],["4031","0"],["4414","1"],["4680","0"],["5163","1"],["5996","0"]],[["0","0"],["500","1"],["8544","0"],["9527","1"]],[["0","1"],["316","0"],["1049","1"],["1648","0"],["1998","1"],["2331","0"],["2614","1"],["3514","0"],["3913","1"]],[["0","0"],["1050","1"],["2299","0"],["2865","1"],["4497","0"],["6380","1"]],[["0","0"],["716","1"],["2315","0"],["5630","1"],["6662","0"],["8194","1"],["10043","0"]],[["0","0"],["833","1"],["2049","0"],["2665","1"],["4514","0"],["6579","1"],["8212","0"]],[["0","0"],["966","1"],["6679","0"],["6929","1"]],[["0","0"],["416","1"],["949","0"],["1582","1"],["3364","0"]],[["0","1"],["233","0"],["899","1"],["1782","0"],["1998","1"]],[["0","0"],["1033","1"],["5863","0"],["7112","1"],["9394","0"]],[["0","1"],["1832","0"],["2915","1"],["4997","0"],["5246","1"],["5696","0"]],[["0","0"],["683","1"],["1149","0"],["1516","1"],["4680","0"],["5796","1"],["6246","0"],["6512","1"],["8378","0"],["9810","1"]],[["0","1"],["817","0"],["1516","1"],["2765","0"],["3764","1"],["4214","0"],["4614","1"]],[["0","0"],["333","1"],["1666","0"],["2615","1"],["3664","0"]]],"maxt":"10043"};

		console.log(data);

		var maxt = data.maxt;

		var numofAOIs = 2;

		swdata = data.switchtimes;

		var numofusers = swdata.length;

		var canvas = document.getElementById("myCanvas");

		var ctx = canvas.getContext("2d");

		var width = canvas.getAttribute("width");
		var height = canvas.getAttribute("height");

		var linesAOIdist = width/numofAOIs;
		var linesuserdist = 0.5*(linesAOIdist/numofusers);

		ctx.beginPath();

		var x = linesAOIdist/2;

		while(x < width){
			for(var i = -numofusers/2;i < numofusers/2; i++){
				ctx.moveTo(x + i * linesuserdist, 0);
				ctx.lineTo(x + i * linesuserdist, height);
			}
			x += linesAOIdist;
		}
		ctx.stroke();

		ctx.lineWidth = linesuserdist/4;

		for(var user = 0; user < numofusers; user++){
			console.log(user);

			var switchtimes = swdata[user];

			var prev = (Number(switchtimes[0][1]) + 0.5)*linesAOIdist + (user - numofusers/2) * linesuserdist;

			ctx.beginPath();
			ctx.moveTo(prev,0);


			for(var i = 1; i < switchtimes.length; i++){
				var t = Number(switchtimes[i][0]);
				var AOI = Number(switchtimes[i][1]);

				var pos = (AOI + 0.5)*linesAOIdist + (user - numofusers/2) * linesuserdist;

				ctx.lineTo(prev,(t/maxt) * height);
				ctx.lineTo(pos, (t/maxt) * height);

				prev = pos;
			}
	
			ctx.strokeStyle = getRandomColor();
			ctx.stroke();
		}


		function getRandomColor() {
		  var letters = '0123456789ABCDEF';
		  var color = '#';
		  for (var i = 0; i < 6; i++) {
		    color += letters[Math.floor(Math.random() * 16)];
		  }
		  return color;
		}


	</script>
</body>
</html>