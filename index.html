<!DOCTYPE html>
<html>
<head>
	<title>Blue skies</title>
</head>
<body>

	<form action="upload.php" method="post" enctype="multipart/form-data">
		Select image to upload:
		<input type="file" name="Upload_file" id="Upload_file">
		<input type="submit" value="Upload CSV" name="submit">
	</form>

	<form action="visAOI.php" id="AOIform" method="post">
		<input type="submit" value="submit AOIs" name="submit AOIs"><br>
		<input type="number" name="xmin0" min="0"><input type="number" name="xmax0" min="0"><input type="number" name="ymin0" min="0"><input type="number" name="ymax0" min="0"><br>

	</form>

	<button onclick="addAOI()">+</button>


	<div>
		<canvas id="myCanvas" width="600" height="600"></canvas>
	</div>
	<script type="text/javascript">


		var data = {"switchtimes":[[["0","1"],["2632","2"]],[["0","1"],["583","2"],["1166","1"],["2232","2"],["2981","1"],["4697","2"]],[["0","1"],["4447","2"],["5546","1"]],[["0","2"],["516","1"],["2315","2"],["3314","1"],["4813","2"],["6029","1"]],[["0","1"],["3149","2"],["3865","0"],["4448","2"],["4781","1"],["6730","2"]],[["0","1"],["2298","2"],["4031","1"],["5163","0"],["5530","2"],["5746","1"]],[["0","1"],["3947","2"],["7695","1"],["10010","2"]],[["0","1"],["1049","2"],["1648","1"],["2848","2"],["3514","1"]],[["0","1"],["3382","2"],["4497","1"]],[["0","1"],["8628","2"],["10043","1"]],[["0","1"],["1316","2"],["1849","1"],["3115","2"],["4514","1"],["6912","2"],["8212","0"],["8495","1"]],[["0","1"],["2832","2"],["4014","1"],["4380","2"],["5097","1"],["6579","2"],["6679","1"]],[["0","1"],["2182","2"],["3364","1"]],[["0","0"],["233","1"],["2215","2"],["2548","1"],["2981","2"],["3414","0"],["3731","2"],["4480","1"]],[["0","1"],["1332","2"],["3314","1"],["5579","2"],["5863","1"],["8328","2"],["9394","1"]],[["0","2"],["1499","1"],["2915","0"],["3098","2"],["3431","1"],["3914","2"],["4997","1"],["5246","2"],["5696","0"]],[["0","1"],["3215","2"],["4181","1"],["6862","2"],["8211","0"],["8378","1"]],[["0","2"],["817","1"],["1599","2"],["2548","1"],["4614","2"],["4930","0"]],[["0","1"],["716","2"],["1233","1"],["2881","2"],["3664","1"]]],"maxt":"10043","numofAOIs":3};


		var maxt = data.maxt;

		var numofAOIs = data.numofAOIs;

		swdata = data.switchtimes;

		var numofusers = swdata.length;

		var canvas = document.getElementById("myCanvas");

		var ctx = canvas.getContext("2d");

		var width = canvas.getAttribute("width");
		var height = canvas.getAttribute("height");

		var linesAOIdist = width/numofAOIs;
		var linesuserdist = 0.5*(linesAOIdist/numofusers);

		ctx.beginPath();

		var x = linesAOIdist/2;

		while(x < width){
			for(var i = -numofusers/2;i < numofusers/2; i++){
				ctx.moveTo(x + i * linesuserdist, 0);
				ctx.lineTo(x + i * linesuserdist, height);
			}
			x += linesAOIdist;
		}
		ctx.stroke();

		ctx.lineWidth = linesuserdist/4;

		for(var user = 0; user < numofusers; user++){
			var switchtimes = swdata[user];

			var prev = (Number(switchtimes[0][1]) + 0.5)*linesAOIdist + (user - numofusers/2) * linesuserdist;

			ctx.beginPath();
			ctx.moveTo(prev,0);


			for(var i = 1; i < switchtimes.length; i++){
				var t = Number(switchtimes[i][0]);
				var AOI = Number(switchtimes[i][1]);

				var pos = (AOI + 0.5)*linesAOIdist + (user - numofusers/2) * linesuserdist;

				ctx.lineTo(prev,(t/maxt) * height);
				ctx.lineTo(pos, (t/maxt) * height);

				prev = pos;
			}
	
			ctx.strokeStyle = getRandomColor();
			ctx.stroke();
		}

		function getRandomColor() {
		  var letters = '0123456789ABCDEF';
		  var color = '#';
		  for (var i = 0; i < 6; i++) {
		    color += letters[Math.floor(Math.random() * 16)];
		  }
		  return color;
		}


	</script>
	<script type="text/javascript">
		var numofAOIs = 1;

		function addAOI() {
			var form = document.getElementById("AOIform");

			form.innerHTML += '<input type="number" name="xmin'+numofAOIs+'" min="0"><input type="number" name="xmax'+numofAOIs+'" min="0"><input type="number" name="ymin'+numofAOIs+'" min="0"><input type="number" name="ymax'+numofAOIs+'" min="0"><br>'
		}
	</script>
</body>
</html>